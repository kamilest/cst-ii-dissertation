\documentclass[12pt,a4paper,twoside]{article}
\usepackage{bookmark}
\usepackage{amsmath}
\usepackage{parskip}
\usepackage{enumitem}
\usepackage{hyperref}
\urlstyle{same}
\usepackage{xcolor}
\usepackage[multiple]{footmisc}
\usepackage[margin=25mm]{geometry}
% \usepackage[backend=biber]{biblatex}
% \addbibresource{stankeviciute-proposal.bib}

\begin{document}

\begin{center}
\Large
Computer Science Tripos -- Part II -- Project Proposal\\[4mm]
\LARGE
Graph neural networks for age prediction from neuroimaging data \\[4mm]

\large
Kamilė Stankevičiūtė (\texttt{ks830}), Gonville \& Caius College

\today % October 2019
\end{center}

\vspace{5mm}
\textbf{Project Originator:} Tiago Azevedo

\textbf{Project Supervisors:} Tiago Azevedo, Alexander Campbell, Prof Pietro Liò

\textbf{Directors of Studies:} Dr Timothy~M.~Jones, Dr Graham~Titmus

\textbf{Project Overseers:} Prof Jon~Crowcroft, Dr Thomas~Sauerwald

% Main document

\section*{Introduction}
% The problem to be addressed.

\textit{Deep learning/graph neural networks intro}

% [Tiago] Why NNs and not something else? You probably want one sentence of motivation saying they have been very successful in other fields, and then one sentence that as a consequence they might help physicians.
% \textit{...Neural networks provide the opportunity to capture the similarities between patients and trends which might help physicians to understand the mechanisms of the disease and in turn find more effective treatments...}

One way of modelling the population is a graph, with nodes representing individuals (their features and the label), and edges corresponding to associations between individuals according to some heuristic or a formally defined similarity metric. Additionally, the graph structure is helpful when incorporating multiple modalities of data (e.g. imaging and non-imaging). \textit{Graph neural network approaches are popular and have proved successful in a broad range of tasks...}

One reason why such graph representation is considered to be useful in the patient population context is that it makes use of both the individual patient data (node feature vectors) and the trends in the population through pairwise similarities (graph edges), inferring the information about the patient's label from their neighbourhood.

\textit{Recently, the differences in brain and chronological ageing have been linked to psychiatric diseases,\cite{kaufmann2019} which may be important in understanding the mechanisms of those disorders and in turn helping physicians to find more effective treatments...}

\section*{Project description}
This project was inspired by a state-of-the-art application of a type of graph neural network called Graph Convolutional Network (GCN), as described in papers by Parisot et al. \cite{parisot2017spectral, parisot2018disease} In these papers, the GCN (adapted from Kipf and Welling \cite{kipf2017semi}) was used in a semi-supervised manner for two tasks: 1) prediction of Autism Spectrum Disorder from the ABIDE dataset and 2) prediction of a progressive form of Mild Cognitive Impairment that develops into Alzheimer's disease from the ADNI dataset.

The aim of this project will be to adapt this approach to a regression task on the UK Biobank data, predicting the subject's age based on brain imaging [\textit{genetic, biomarker and other}] data, and comparing it to another successful geometric deep learning architecture such as the Graph Attention Network. The networks will be evaluated – in addition to the usual metrics like accuracy and AUC – on their \textit{robustness} to missing or noisy data.


\section*{Starting point}
% Describe existing state of the art, previous work in this area,
%   libraries and databases to be used. Describe the state of any
%   existing codebase that is to be built on.

The source code for the implementation of Kipf and Welling's \cite{kipf2017semi} GCNs and Parisot et al.'s \cite{parisot2018disease} first classification task is publicly available online.\footnote{\url{https://github.com/tkipf/gcn}}\footnote{\url{https://github.com/parisots/population-gcn}}

I will be using PyTorch for this project because of its support for machine learning on structured graph data. In particular, PyTorch Geometric (PyG)\footnote{\url{https://github.com/rusty1s/pytorch_geometric}} – a geometric deep learning extension library – will make the implementation, iteration and extensions to the model more flexible in addition to performance improvements and simplified APIs.
% making the final library more accessible and extensible, contributing to the open-source community

I have experience with the basics of TensorFlow\footnote{Five-course Deep Learning specialisation by deeplearning.ai on Coursera}\footnote{Google's Machine Learning Crash Course and follow-up courses.} and no experience with PyTorch or graph neural networks. I have attended or will study (possibly in advance) the CST courses related to the subject of this project, such as IA Machine Learning and Real-World Data, IB Artificial Intelligence, II Bioinformatics, II Machine Learning and Bayesian Inference.

I will be using the data from the UK Biobank, kindly preprocessed and provided by Dr~Richard Bethlehem of the Department of Psychiatry.

\section*{Resource declaration}

For this project I will be using my personal MacBook Pro (2019, with 1.4 GHz Quad-Core Intel Core i5 processor and 8GB of RAM). Training the model will require the use of GPUs provided by the Computational Biology Group (as confirmed by Prof Pietro Liò). To prevent any loss of data, both the source code and \LaTeX\ source will be stored on my machine, private GitHub repositories, and Google Drive, as well as regularly backed up on an external HDD.

\section*{Work to be done}
\label{section:work}

% [Tiago] bullet points should start with the same sentence structure

% Describe the technical work.
List of explicit tasks and \textbf{deliverables}.
\begin{itemize}
  \item \textit{Deliverable}: The data is preprocessed into features and is ready for analysis. [What if the data is already pre-processed?] % [Tiago] "data cleaned and is ready for analysis" 
  \item \textit{Deliverable}: Definition of the similarity metric and threshold to be used in connecting the graph. The graph is connected to be processed by the graph neural Networks.
  \item \textit{Deliverable}: Implementation of Kipf's GCN \cite{kipf2017semi} (\texttt{GCNConv} in PyG) for age regression task.
  % [Tiago] GAT originally doesn't allow for weighted edges. You probably want to say GAT because of interesting results in previous literature. Thus, you can probably divide this point: (1) implementation of another graph NN layer, (2) Include weights (in theory you can even edit the message passing mechanism in GCN to multiply by the weights, just like you are suggesting for GAT) 
  \item \textit{Deliverable}: Implementation of the Graph Attention Network for comparing its performance to the Graph Convolutional Network.
  % [Tiago] What exactly would you be testing points? Eg. what a unit test would consist of?
  \item \textit{Unit tests for preprocessing correctness?}
  % [Tiago] I just recalled that one thing we discussed could be how it handles missing data (eg. a certain percentage without some data), which could create an interesting view on robustness and semi-supervised learning. Maybe this could go to extension (or "personal" extension in case you have time and you can say you had one more extension than initially planned)
\end{itemize}

\textbf{Evaluation framework}

\begin{itemize}
  \item  \textit{Deliverable}: Comparison of the alternative graph neural network models using the accuracy and AUC (measures used in the Parisot et al.'s work \cite{parisot2018disease}).
  \item \textit{Deliverable}: A robustness measure for the GCN due to missing data, and comparison of robustness of the two models.
\end{itemize}

\section*{Success criteria}
% Describe what you expect to be able to demonstrate at the
% end of the project and how you are going to evaluate your achievement.
\begin{itemize}
  \item Represent the UK Biobank data as a population graph with nodes representing the individuals and edges representing associations between them based on pairwise similarity.
  \item Implement the Graph Convolutional Network for age regression on the population graph.
  \item Implement the Graph Attention Network for the same task.
  \item Implement the framework for measuring robustness, and compare the two graph neural networks.
\end{itemize}

\section*{Evaluation of the project}
The performance of the graph neural networks will be measured – in addition to accuracy and AUC used in Parisot et al.'s work \cite{parisot2018disease} – through \textit{robustness to missing or noisy data}. Robustness, which could be defined as the \textit{rate at which the accuracy drops as more information is removed from the nodes}, would reveal how important is the neighbourhood (edge) information for accurate predictions compared to the node features only.

\section*{Possible extensions}
% Potential further envisaged evaluation metrics or extensions.
\begin{itemize}
  \item Implement spectral filter computation with \textit{Cayley polynomials} instead of using Chebyshev polynomials. Cayley polynomials have been introduced in a paper by Levie et al. \cite{levie2017cayleynets} and were mentioned in \cite{parisot2018disease} as a possible improvement.
  \item In the main implementation the graph neural network must take in the extracted features from the brain imaging data and is unable to work on common data structures for raw neuroimaging files such as BIDS.\footnote{\url{https://bids.neuroimaging.io}} Time permitting, an extension could be to create an extra package for neuroimaging data preprocessing that can be appended to the beginning of the model pipeline, which would make the execution more efficient, robust and generalisable.  
  \item Implement weighted edges in the Graph Convolutional Network and Graph Attention Network, as the implementation will have binary edges with weights being either 0 or 1.
  \item Implement a \textit{custom similarity metric}. The metrics used in the work by Parisot et al. \cite{parisot2018disease} were defined arbitrarily by the authors based on very few features. Learning a different similarity metric based on more combinations of features could possibly result in a better performance of the classifier.

\end{itemize}


\section*{Timetable and milestones}
\label{section:timetable}

% A work plan of perhaps ten or so two-week work-packages,
% as well as milestones to be achieved along the way. Provide a
% target date for each milestone.

% [Tiago] you can specify which parts of the work you intend to implement in each 2-week time frame. This will help you having a better idea of how you are keeping up/behind.

%  (01/10/2019 – 16/10/2019)
\textbf{Michaelmas weeks 0-1}

\textit{Preparation.} Read Graph Convolutional Network papers, get familiar with PyTorch Geometric, work on project proposal [...]

\textbf{Milestones.} Submit Phase 1 report by 14/10/2019. Submit draft proposal by 18/10/2019.

% (17/10/2019 – 06/11/2019)
\textbf{Michaelmas weeks 2–4}

\textit{Preparation.} Get familiar with the features of UK Biobank data, define a similarity metric.

\textbf{Milestones.} Submit final project proposal by 25/10/2019.

% (07/11/2019 – 20/11/2019)
\textbf{Michaelmas weeks 5–6}

\textit{Core work.} Work on the implementation of the Graph Convolutional Network on PyTorch for the UK Biobank data.

% (21/11/2019 – 04/12/2019)
\textbf{Michaelmas weeks 7–8} 

\textit{Core work.} Work on the implementation of the Graph Attention Network for the same task.

\textbf{Michaelmas vacation}

\textit{Core work. Some write-up. Progress report and presentation.}  Write the implementation for evaluation framework, measuring robustness and other metrics of the alternative approaches. Start writing the dissertation.

\textbf{Milestones.} Complete the implementation of the main part of the project.

% (16/01/2020 – 29/01/2020)
\textbf{Lent weeks 0–2}

\textit{Extensions.} Work on progress report and presentation, implement Cayley polynomials.
 
\textbf{Milestones.} Submit progress report by 31/01/2020.


% (30/01/2020 – 19/02/2020)
\textbf{Lent weeks 3–5}

\textit{Extensions, start evaluation.} Work on implementing the data preprocessing/weighted edges.

% (20/02/2020 – 11/03/2020)
\textbf{Lent weeks 6–8}

\textit{Extensions, evaluation, write-up.} Write the dissertation.

\textbf{Easter vacation}

\textit{Write-up.} Work on the dissertation draft.

\textbf{Milestones.} Send out the complete draft for review by 27/03/2020. Submit dissertation early by 20/04/2020.

% (24/04/2020 – 06/05/2020)
\textbf{Easter weeks 0–2}

 Time reserved for any unexpected issues.

% \medskip 
% \printbibliography
\bibliographystyle{unsrt}
\bibliography{stankeviciute_project_proposal}

\end{document}